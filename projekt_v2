#include <LCD_I2C.h>

LCD_I2C lcd(0x3F, 16, 2); 

long odleglosc, duration;

void setup()
{
  
    for(int dioda = 3; dioda < 12; ++dioda){
      pinMode(dioda, OUTPUT);
    }

    pinMode(A2, OUTPUT);
    pinMode(A1, INPUT);
    
    lcd.begin(); 
    lcd.backlight();
    for(int i = 4; i < 14; ++i){
      pinMode(i, OUTPUT);
    }
}

void loop() {
      pinMode(A2, OUTPUT);
      digitalWrite(A2, LOW);
      delayMicroseconds(2);
      digitalWrite(A2, HIGH);
      delayMicroseconds(10);
      digitalWrite(A2, LOW);
      pinMode(A2, INPUT);
      
      duration = pulseIn(A1, HIGH);
      odleglosc = microsecondsToCentimeters(duration);

      if(odleglosc > 0 && odleglosc <= 5){
          digitalWrite(3, HIGH);
          for(int dioda = 4; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
          }   
      else if(odleglosc > 5 && odleglosc <= 10){
          digitalWrite(4, HIGH);
          for(int dioda = 5; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
          }
      else if(odleglosc > 10 && odleglosc <= 15){
          digitalWrite(5, HIGH);
          for(int dioda = 6; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
        }
      else if(odleglosc > 15 && odleglosc <= 20){
          digitalWrite(6, HIGH);
          for(int dioda = 7; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
        }
      else if(odleglosc > 20 && odleglosc <= 25){
          digitalWrite(7, HIGH);
          for(int dioda = 8; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
        }
      else if(odleglosc > 25 && odleglosc <= 30){
          digitalWrite(8, HIGH);
          for(int dioda = 9; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
        }
      else if(odleglosc > 30 && odleglosc <= 35){
          digitalWrite(9, HIGH);
          for(int dioda = 10; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
        }
      else if(odleglosc > 35 && odleglosc <= 40){
          digitalWrite(10, HIGH);
          for(int dioda = 11; dioda < 12; dioda++){
              digitalWrite(dioda, LOW);
            }
            delay(1000);
        }
      else if(odleglosc > 40 && odleglosc <= 45){
          digitalWrite(11, HIGH);
          digitalWrite(12, LOW);
          delay(1000);
        }
      else if(odleglosc > 45){
          digitalWrite(12, HIGH);
          delay(1000);
      }

      lcd.setCursor(0, 0);
      lcd.print(odleglosc);
      delay(1000);
      lcd.print("                ");
      
}

long microsecondsToCentimeters(long microseconds) {
   return microseconds / 29 / 2;
}
